\documentclass[dvipdfmx]{article}
\usepackage{siunitx}
\usepackage[dvipdfm]{hyperref}
\usepackage[dvipdfmx]{graphicx}
\usepackage{bm}
\usepackage{fancyhdr}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{amsmath,amssymb}
\usepackage{here}
\usepackage{ascmac}
\usepackage[dvipsnames]{xcolor}
\usepackage{url}
\usepackage{colortbl}
\usepackage{comment}


\title{砂時計のシミュレーション}

\author{陰山 聡$^\dagger$、 中島 涼輔$^\dagger$、中戸 昂明$^\ddagger$ \\[0.5em] 
        $^\dagger$神戸大学システム情報学研究科、$^\ddagger$神戸大学システム情報学部 }
\date{\today}

\begin{comment}
\end{comment}

\begin{document}

\maketitle


\begin{abstract}
砂時計の砂が落ちている間、砂時計の重さはわずかに重くなることが知られている。
その重さの変化はとても小さいので、この効果の実験的な検証は容易ではない。
ソフトスフィアモデルに基づいた個別要素法シミュレーションにより、砂時計の重さの変化を再現した。
\end{abstract}


%=============================================
\section{はじめに}
%=============================================
砂時計を重量計に乗せて、砂時計の重量を計る状況を考えよう。
砂時計の砂が落ち始める前の砂時計全体の重さと、
砂がすべて落ちきった後の砂時計全体の重さはもちろん変わらない。
では、砂が落ちている最中の砂時計の重さはどうであろうか。
これは大学で学ぶ力学、特に力積の概念を使うよい練習問題になりそうであるが、
実際には力学の教科書などで取り上げられる例は少ない。
それはこの問題の正解が「理論上は少しだけ重くなるが、実際上は変わらないといってよい」というあまりすっきりしないものであるために初学者には教育的でないからかもしれない。


砂が落ちている間、砂時計がわずかに重くなるであろうことは砂の重心の運動から容易に予想される。
計時開始前には砂時計の上部にあった砂粒全体の重心は、
計時後には下部に移動している。
上部の砂層の厚さとそこに含まれる砂の質量は時間$t$の線形で減少する一方、
下部の砂層の厚さと質量は線形で増加する。
したがって全体の重心位置は$t$の2次関数で減少（落下）するが、その2階微分（加速度）の向きは自由落下とは反対に上向きである。
つまり砂時計全体は重くなるはずである。


ただし、重心移動の距離はわずかで最大でも砂時計の高さ程度あり、
しかもかなり時間をかけたゆっくりとした移動（砂時計が3分計であれば3分間）なので、
その加速度は必然的に小さく、したがって砂時計全体の重さに与える影響は小さいことは予想できる。


GardnerがScientific American誌で水中を浮力で浮かぶ砂時計を使ったおもちゃを紹介したときが砂時計の重さが大きな注目を集めた最初であろう\cite{Gardner1966-eu}。
その後すぐに、落下した砂が砂時計の底面に与える力積（つまり砂時計を重くする効果）が、
落下中の砂の分だけ砂時計の重さが軽くなる効果とちょうどキャンセルするという指摘がされた\cite{Reid1967-jq}。
そこでは、力学教育のよい題材にこの問題はなるであろうとも指摘されている。


その後、砂の重心の移動まで考慮に入れると砂時計はわずかに重くなることが指摘された\cite{ShenUnknown-pk}。
著者等は理論解析に加えて実験を行い、ガラスの粉末を使った「砂」時計の重量を測定して、実際に重くなることを示した。
重さの変化は、理論予想が49~\si{mg}に対して実験結果は$30\sim 80$~\si{mg}の範囲であった。
おそらくこれがこの効果を最初に実証した実験であろう。


日常目にする砂時計は真ん中がくびれていて、オリフィスは一つである。
当然、落下する砂粒の流れも一本なので、オリフィスよりも上の部分ではそれぞれの砂粒は水平方向に運動する。
また、下面に降り積もった砂もまた複雑な水平運動をする。
この複雑さを回避するするために、Tuinstra等は単一のオリフィスではなく多数（230個）の穴を持つ「ふるい」で区切られた円筒状の砂時計モデルを作成し、
（本物の）砂$1.6$~\si{kg}を使った実験を行った\cite{Tuinstra2010-wk}。
理論的的には$0.116$~\si{g}の重さの増加が期待され、測定結果は$0.121$~\si{g}であった。


金属粉末を使った実験で、砂時計の重さの時間変化が詳細に解析されている\cite{Sack2017-rq}。
時間変化は主に3つの時期に分けることができる。
最初期、砂が落ち始めた直後から最初の砂粒が下面に到達するまでの短い間、砂時計の重量は軽くなる。
これは空中にいる砂粒の重量分だけ重みがかからないためである。
また、最終期、最後の砂粒が落ちている短い間は、砂時計は重くなる。
これは下面を叩く砂粒達が与える力積をキャンセルするだけの数の砂が空中にないためである。
この二つ短い遷移時間の間、浮いている砂粒の軽さと床面に衝突する砂粒が与える力積がキャンセルするが、
冒頭に述べた重心に移動効果により、重量が一定の値でわずかに重くなる時期が続く。


砂時計の重さの問題は、多くの非自明な要因が関係する力学の問題として興味深いだけでなく、
質量が時間変化する系の典型例として教育的にも重要であると指摘されている\cite{Kassandrov2023-tn}。


コンピュータシミュレーションでこの効果、つまり砂が落下している最中の砂時計がわずかに重くなる効果を実証した研究はまだないようである。
本研究の目的は、簡単でありながら高精度な砂時計のコンピュータシミュレーションモデルを開発することである。
我々のモデルは、落下中の砂の分だけ軽くなる効果と落下した砂が与える力積がちょうどキャンセルするという基本的な効果を再現することはもちろん、
砂の重心移動によるわずかな重さの変化という微弱な効果も定量的に再現する。
このシミュレーションはプログラミング初心者にも扱えるようデザインされたProcessing言語\footnote{\url{https://processing.org}}で書かれており、
そのソースコードは公開する予定である\footnote{\url{https://github.com/akageyama/lab-project-hourglass}}。
ノートPCで実行可能なほど小規模なシミュレーションなので、
この興味深い力学問題を直接体験することができる。


%=============================================
\section{理論}
%=============================================


%------------------------------------------
\subsection{力積に基づく抗力の概算}
%------------------------------------------

$T_0$秒間を測る砂時計を考える。
重力加速度を$g$、砂粒の総数を$N_0$、砂全体の質量を$M_0$とすると、
砂粒一つの質量$m$は、
%==========
\begin{equation} \label{250517100232} 
   m = \frac{M_0}{N_0} 
\end{equation}
%==========
である。
1秒間に落ちる砂粒の数を
%==========
\begin{equation} \label{250515082817} 
   \mu = \frac{N_0}{T_0}
\end{equation}
%==========
とする。
$m$と$\mu$は


鉛直上向きに$y$軸をとり、
砂が落ちる位置すなわちオリフィスの位置を$y=0$とする。
最初の砂粒が落下する距離、つまり砂時計の底面の位置を$y=-H_0$とする。


一つの砂粒がオリフィスから落下し、下部に積み重なった砂の層の表面まで到達するのにかかる時間、つまり自由落下時間を$\tau_f$とし、
下に落ちた砂粒は跳ね返らずに短い時間で静止すると仮定する。
落下した瞬間の砂粒の速さ（自由落下速度）は
%==========
\begin{equation} \label{250512190520} 
   V_F = g\tau_f
\end{equation}
%==========
なので、落下によって静止した砂粒の運動量の変化は
%==========
\begin{equation} \label{250512190655} 
   p = mg\tau_f
\end{equation}
%==========
である。
$\Delta t$秒間に落下する$\mu \Delta t$個の砂粒が下面に与える運動量の総量$p\mu \Delta t$は力積$F_\mathrm{i} \Delta t$に等しいので、
%%==========
%\begin{equation} \label{250512191540} 
%   F_\mathrm{i} \Delta t = \mu \Delta t  mg\tau_f
%\end{equation}
%%==========
床面に与える平均力は
%==========
\begin{equation} \label{250515093535} 
  F_\mathrm{i}   = \mu m g \tau_f
\end{equation}
%==========
である。


一方、ある瞬間に落下している途中、つまり砂時計のオリフィスから下面までの中空にいる砂粒は$\mu \tau_f$個ある。
一つの砂粒にかかる重力は$mg$なので、
砂時計全体の重さはこの落下中の砂粒の重さ
%==========
\begin{equation} \label{250513083619} 
   F_\mathrm{s} = \mu \tau_f mg 
\end{equation}
%==========
だけ軽くなる。
これは力積による平均力、つまり式~\eqref{250515093535}と等しい。
従って砂が落ちている最中の砂時計全体の重さは変わらない、という結論になりそうだが、以下に示すように厳密にはこれは正しくない。


%------------------------------------------
\subsection{運動方程式に基づく抗力の正確な評価} \label{250919151350}
%------------------------------------------

砂時計の床面に働く抗力を求めるために運動方程式を立てる。
オリフィスよりも上にある砂の層を質量$M_1(t)$をもつ物体1、
下に落下して静止した砂の層を質量$M_2(t)$をもつ物体2、
落下中の砂粒全体を物体3とみなす。
これは可変質量の物体が相互作用する力学の問題である。
%-------------------------------------------------------
\begin{figure}[ht]   \centering   
  \includegraphics[%
     height=1.0\textheight,%
       width=0.4\hsize,keepaspectratio]%
         {./figs/schematic_objects_and_forces.png}   
      \caption{CAPTION.}
      \label{250919103231}
\end{figure} 
%-------------------------------------------------------



簡単のため、オリフィス付近を除いた砂時計の断面積は一定とする。
計時を開始する前の砂の層の厚さを$K_0$、
砂粒の高さあたりの質量密度を$\sigma$とすると
%==========
\begin{equation} \label{250703152145} 
   \sigma = \frac{M_0}{K_0} %= \frac{mN_0}{K_0} 
\end{equation}
%==========
である。
%==========
\begin{equation} \label{250919090329} 
   \frac{m\mu}{\sigma} = \frac{K_0}{T_0}
\end{equation}
%==========
という関係がある。


%- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
\subsubsection{物体1（落下前の上の砂層）}
%- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
計時開始時刻を$t=0$とすると、
時刻$t$では$\mu t$個の砂粒がオリフィスから落下しているので、
この時刻にオリフィスの上の部分にある砂、つまりまだ落下していない砂の数は
%==========
\begin{equation} \label{250703152453} 
   N_1(t) =  N_0 - \mu t
\end{equation}
%==========
である。
したがってオリフィス上部の砂の質量は
%==========
\begin{equation} \label{250703152655} 
   M_1(t) = m (N_0-\mu t)
\end{equation}
%==========
である。
この時刻におけるオリフィス上部の砂層の厚さは
%==========
\begin{equation} \label{250703152748} 
   K_1(t) = \frac{M_1(t)}{\sigma} = \frac{m}{\sigma} (N_0-\mu t)
\end{equation}
%==========
である。
上の層の厚さは一定の割合で減少する。
%==========
\begin{equation} \label{250919084914} 
   \dot{K}_1(t) = -\frac{m\mu}{\sigma}
\end{equation}
%==========
この層の重心の$y$座標を$Y_1(t)$とすると
%==========
\begin{equation} \label{250703153013} 
   Y_1(t) = \frac{K_1(t)}{2} = \frac{m}{2\sigma} (N_0-\mu t)
\end{equation}
%==========
物体1の運動量は
%==========
\begin{equation} \label{250917102959} 
   P_1(t)  = M_1(t) \dot{Y}_1(t) 
\end{equation}
%==========
その時間微分は
%==========
\begin{equation} \label{250919104731} 
   \dot{P}_1(t) = \dot{M}_1(t)\dot{Y}_1(t) = \frac{m^2\mu^2}{2\sigma}
\end{equation}
%==========
である。
運動量$P_1$は下向き（$P_1<0$）であるが、その時間変化$\dot{P}_1$は上向き（$\dot{P}_1>0$）である。


%- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
\subsubsection{物体2（落下後の下の砂層）}
%- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
同様に下の砂層の厚さを$K_2(t)$、質量を$M_2(t)$とする。
これらの量が正になるのは時刻$t=0$に落下した最初の砂粒が下の床に到達するまでの時間、
つまり自由落下時間
%==========
\begin{equation} \label{250703153227} 
   \tau_{f0} = \sqrt{\frac{2H_0}{g}}
\end{equation}
%==========
以降である。
%==========
\begin{equation} \label{250919091147} 
   M_2(t) = m\mu (t-\tau_{f0})
\end{equation}
%==========
と近似できる。
$\mu$という一定の割合で砂粒が落ちてくるのだからこの式は自明のようにも思えるが、
正確にいえばこの式は
%==========
\begin{equation} \label{250919092251} 
   \epsilon = \frac{K_0/T_0}{\sqrt{2gH_0}}  \ll 1
\end{equation}
%==========
だけの誤差を含む（Appendix~\ref{250919092352}参照）。
下の砂層の厚さは
%==========
\begin{equation} \label{250919104425} 
   K_2(t) = \frac{M_2(t)}{\sigma} = \frac{m\mu}{\sigma}(t-\tau_{f0})
\end{equation}
%==========

下の砂層の重心の$y$座標は
%==========
\begin{equation} \label{250703154424} 
   Y_2(t) = -H_0 + \frac{K_2(t)}{2} 
\end{equation}
%==========
である。
物体2の運動量は
%==========
\begin{equation} \label{250917103019} 
   P_2(t) = M_2(t)\dot{Y}_2(t)  
\end{equation}
%==========
その時間微分は
%==========
\begin{equation} \label{250919104243} 
   \dot{P}_2(t) = \dot{M}_2(t)\dot{Y}_2(t) = \frac{m^2\mu^2}{2\sigma}
\end{equation}
%==========
である。


%- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
\subsubsection{物体3（落下中の砂粒）}
%- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
$t\ge \tau_{f0}$のある時刻$t$に落下している最中の砂粒は、
高さ
%==========
\begin{equation} \label{250919083726} 
   K_3(t) = H_0 - K_2(t)
\end{equation}
%==========
に分布している。
その総数は
%==========
\begin{equation} \label{250917175724} 
   N_3(t) = \mu \tau_f(t) = \mu \sqrt{\frac{2K_3(t)}{g}} = \mu \sqrt{\frac{2(H_0-K_2(t))}{g}} = \mu \sqrt{\frac{2}{g}}\sqrt{H_0-K_2(t)}
\end{equation}
%==========
である。したがって質量は
%==========
\begin{equation} \label{250917175839} 
   M_3(t) = mN_3(t) %= m \mu \sqrt{\frac{2(H_0-K_2(t))}{g}} 
   		 = m\mu\sqrt{\frac{2}{g}}\sqrt{H_0-K_2(t)}
\end{equation}
%==========
である。



物体3の運動量を評価するためにまず、物体3内部の運動量分布は高さ$y$によらず一定であることに注意する。
位置$y$を速度$v_y(y)$で下方$(v_y<0)$に通過する砂粒の数は常に$\mu$個なので、砂粒の数密度を$n(y)$とすると、
%==========
\begin{equation} \label{250917101402} 
   n(y) v_y(t) = -\mu = \text{const.}
\end{equation}
%==========
である。したがって物体3の運動量の密度は
%==========
\begin{equation} \label{250917102631} 
   p_3 = mn(y)v_y(y)= -m \mu = \text{const.}
\end{equation}
%==========
は一定である。
したがって物体3の運動量は
%==========
\begin{equation} \label{250917102719} 
   P_3(t) =p_3 K_3(t) =  -m\mu(H_0-K_2(t))
\end{equation}
%==========
である。
その時間変化は
%==========
\begin{equation} \label{250919105348} 
   \dot{P}_3(t) = \frac{m^2\mu^2}{\sigma}
\end{equation}
%==========
である。


%- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
\subsubsection{運動方程式}
%- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

$F_1 (>0)$を砂時計の構造体が（オリフィスのある面で）物体1を支える抗力、
$F_2 (>0)$を砂時計の構造体が（底面で）物体2を支える抗力とする。
この二つの和$F=F_1+F_2$は砂時計の構造体が砂を支える力である。
砂が落ちている間に$F$が砂にかかる重力$M_0 g$よりも大きければ砂時計は重くなる。


物体1と物体3の間に作用する力を$F_{13}$、物体2と物体3の間に作用する力を$F_{32}$とすると、
この系の運動方程式は
%==========
\begin{align}
   \frac{\mathrm{d} }{\mathrm{d} t}  P_1(t) &=   - M_1(t) g + F_{13} + F_1\label{250703155015a}  \\
   \frac{\mathrm{d} }{\mathrm{d} t} P_2(t)  &=  - M_2(t) g  + F_{32} + F_2 \label{250703155015b} \\
   \frac{\mathrm{d} }{\mathrm{d} t} P_3(t) &=  - M_3(t) g  - F_{13} - F_{32} \label{250703155015c} 
\end{align}
%==========


上の3つの式の両辺を足し、
式\eqref{250919104731}, \eqref{250919104243}, \eqref{250919105348}を使うと
%==========
\begin{equation} \label{250917103450} 
  2\frac{m^2\mu^2}{\sigma}=  -(M_1+M_2+M_3) g + F_1 + F_2
\end{equation}
%==========
したがって
%==========
\begin{equation} \label{250919105951} 
   F = F_1 + F_2 = M_0 g +  2\frac{m^2\mu^2}{\sigma}
\end{equation}
%==========
つまり計時中の砂時計が砂を支える抗力は、右辺第2項
%==========
\begin{equation} \label{250703173105} 
   \Delta F  = 2 \frac{m^2\mu^2}{\sigma}  = 2 \frac{M_0K_0}{T_0^2} 
\end{equation}
%==========
だけ大きくなる。
最後の式変形では式\eqref{250919090329}と$m\mu=M_0/T_0$を使った。
力ではなく重さで表現すれば
%==========
\begin{equation} \label{250703173052} 
    \Delta W  =  2 \frac{M_0K_0}{gT_0^2} 
\end{equation}
%==========
である。


Tuinstra等はくびれのない円筒形の容器を作り、その真ん中に設置した多数の穴をもつ「ふるい」状の板を通過して落下する砂柱の同時落下で実験を行った\cite{Tuinstra2010-wk}。
その実験では$M_0=1.6~\si{(kg)}$、$T_0=23.6~\si{(s)}$、$K_0=0.198~\si{(m)}$である。
%
% --------------------------------------------------------------------------------------------------------------------------------
% メモ：彼らの論文では 
%      M = 1.6 （kg）
% の砂を使ったとかかれているがTとK (彼らはLと書いている）の値は明記されていない。その代わり、測定値から
%     M/T = 67.8 \times 10^{-3} (kg/s)
%     L/T = 0.84 \times 10^{-2} (m)
%  と書かれている。L/Tは時間の経過にともなって砂の層が薄くなるその速さを測定している。
%  同様にM/Tも実測している。巧妙である。この3つの値からM, L(=K_0), Tを計算したのが上の値である。
% --------------------------------------------------------------------------------------------------------------------------------
式\eqref{250703173052}から評価される重さの変化は$\Delta W = 1.16\times 10^{-4}~\si{(kg)}$である。
彼らの測定値は$\Delta W = (1.21\pm 0.06)\times 10^{-4}~\si{(kg)}$であった。
相対的にこれほど微小な重さの差を検出するためには高精度の重量計と洗練された実験技術が必要である。


%=============================================
\section{シミュレーションモデル}
%=============================================
%------------------------------------------
\subsection{砂粒のモデル}
%------------------------------------------

我々は粒子法（個別要素法）に基づくシミュレーションによって砂時計の重さの変化を再現する。
第\ref{250919151350}節で述べた理論は、砂粒の水平方向の運動は全く寄与しておらず、この現象は本質的に1次元的運動であることから、このシミュレーションにおいても1次元モデルを採用する。
落下する砂は複数の本数があるが、それぞれの砂柱は常に鉛直方向に1次元的な運動をする。
下の砂層に到達した砂粒は水平方向に動くことはなく、落ちた順番に上に積み上がっていく。
砂粒同士の接触相互作用は上下二つの隣の砂粒とだけ考えればよい。


砂粒同士の相互作用および砂粒と床面との相互作用はソフトスフェアモデルで表現する。
一つの砂粒を半径$a$、質量$m$の球とする。
$i$番目の砂粒と、下方にいる隣の砂粒$i-1$との距離が$2a$よりも大きい場合は互いに力をおよぼすことはない。
各砂粒は自然長$a$、ばね定数$k$のバネがあるものとする。
したがって粒子間距離が$2a$未満になった場合にバネによる反発力が生じる。
また、粒子同士の相対速度の大きさ$v$に比例して$bv$の抵抗力が生じるダンパーを想定する。


砂時計の中の砂粒が砂時計の床面、あるいは他の砂粒に高速で衝突したときもほとんど跳ね返ることなく静止する。
完全非弾性衝突に近いこのような現象をソフトスフェアモデルで再現するためには適切な$k$と$b$を設定するだけでなく、
十分に細かい時間刻み幅$\Delta t$をとる必要がある。
本シミュレーションでは時間積分法として陽的4次ルンゲ・クッタ法を採用した。


砂時計のオリフィスの位置から床面までの距離を$H_0$とする。
最初の砂粒は高さ$H_0$から自由落下し、速度
%==========
\begin{equation} \label{250919160111} 
   v_{f0} = \sqrt{2gH_0}
\end{equation}
%==========
で砂時計の床面に衝突し、静止する。
ここで$g$は重力加速度である。
本シミュレーションでは$g=9.80665$~\si{(m/s)}とした。
砂粒の半径と自由落下速度できまる時間スケールは
%==========
\begin{equation} \label{250919160801} 
   \tau_{f0} = \frac{a}{v_{f0}}
\end{equation}
%==========
である。
時間刻み幅は
%==========
\begin{equation} \label{250919160045} 
   \Delta t = \alpha \tau_{f0}
\end{equation}
%==========
として決める。
ここで係数$\alpha$は十分小さい値で、本シミュレーションでは$\alpha=10^{-3}$とした。
バネ定数$k$は単振動の周期が$\tau_{f0}$と等しくなるよう
%==========
\begin{equation} \label{250919161147} 
   k = m\left(\frac{2\pi}{\tau_{f0}}\right)^2
\end{equation}
%==========
と設定する。
ダンパーの減衰係数は定数$\beta$を
%==========
\begin{equation} \label{250919162003} 
   b = \beta b_0
\end{equation}
%==========
として与える。
ここで$b_0=2\sqrt{mk}$は臨界減衰係数で、
$\beta$は定数である。
本シミュレーションでは$\beta=10$とした。


%------------------------------------------
\subsection{砂時計のモデル}
%------------------------------------------
砂時計は二つの床面をもつ「2階建て」構造をもつ。
床面は$y=0$と$y=-H_0$にあり、ここでは前者を$U_F$ (Upper floor) 、後者を$L_F$ (Lower floor)と呼ぶ。
$t=0$に最初の砂粒が落ち始める時刻に、上の床は全部で$N_\text{p}$本の砂柱（sand pile）を支えている。
各砂柱には固有の整数$p$ ($0\le p < N_\text{p}$) を割り当てる。
一本の砂柱は$N_\text{s}$個の砂粒から構成される。
砂粒には固有の番号$i$ ($0\le i < N_\text{s}$)をつける。
$0$番目の砂粒が一番下で、$N_\text{s}-1$番目の砂粒が一番上である。
砂粒が落下し、衝突しても、各砂粒の上下の位置関係が変わることはない。


シミュレーション開始時に、すべての砂柱を$U_F$よりも上方に配置し、
$t=0$から全部で$N_0 = N_\text{p} N_\text{s}$個の砂粒の運動方程式を解く。

ある一つの砂柱の中の$i$番目の砂粒の$y$座標を$y_i$と書くと、その運動方程式は、
%==========
\begin{equation} \label{250919171805} 
   m \frac{\mathrm{d}^2 y_i}{\mathrm{d} t^2} = -mg + F_{i,{U_F}} + F_{i,{L_F}}  - F_{i,i+1} + F_{i,i-1}
\end{equation}
%==========
である。
ここで $F_{i,{U_F}}$, $F_{i,{L_F}}$, $F_{i,i+1}$, $F_{i,i-1}$は、
それぞれ上の床$U_F$から受ける抗力、下の床$U_F$から受ける抗力、
上の砂粒と接触した場合に受ける下向きの力（バネ力とダンパー力の和）、
下の砂粒と接触した場合に受ける上向きの力である。


上の床 $U_F$と接触している粒子は常に0個または1個である。
粒子$i$が$U_F$と接触していなければ$F_{i,{U_F}}=0$である。
下の床$L_F$についても同様である。


各砂柱は、上の床$U_F$と接触する可能性のある粒子番号を保持している。
シミュレーション開始時にはその番号は$i=0$（砂柱の中で一番下に位置する砂粒）である。
シミュレーション開始時に$i=0$の砂粒が$U_F$から半径$a$よりも大きな距離だけ離れている、つまり接触していない場合でも、
時間の経過と共にこの粒子0は落下し、いずれ$U_F$と接触する。
この粒子0は$U_F$から上向きの力$F_{i,{U_F}}$の力を受けて減速し、やがて静止するが、
静止する前、あるいはまだ動いている間に、上方から別の粒子$i=1$が落下し、衝突して下向きの力$-F_{01}$を粒子0に及ぼす。
そしてこの粒子1もまたその上の粒子2によって上から押さえつけられる。


十分に時間が経過すると、この砂柱の粒子はすべて静止する。
この状態では、一番下の粒子0は自分自身の重みに加えて、上に積まれた$(N_\text{s}-1)$個の粒子の重みによって下方に押さえつけられ、
その力は床$U_F$とのバネ力$F_{0,{U_F}}$とつり合っている。
つまり$F_{0,{U_F}}=N_\text{s} mg$であり、床$U_F$が砂柱を支える抗力がこの$F_{0,{U_F}}$である。


オリフィスを通過して落下する砂粒の数が時間的に一定であることが砂時計の基本性質である。
このBeverloo則を本研究では次の方法で実装した。



%-------------------------------------------------------
\begin{figure}[ht]   \centering   
  \includegraphics[%
     height=1.0\textheight,%
       width=1.0\hsize,keepaspectratio]%
         {./figs/pillars05Nsp20Combined.jpg}   
      \caption{CAPTION.}
      \label{250919165122}
\end{figure} 
%-------------------------------------------------------






%=============================================
\section{まとめ}
%=============================================
%砂が落ちていないときの砂の層の厚さを$K_0$、砂の全質量を$M_0$、砂時計が測る時間を$T_0$とすると、砂が落下しているときの砂時計は、
%%==========
%\begin{equation} \label{250518122927} 
%   \Delta W = 2 M_0 \frac{K_0}{T_0^2} 
%\end{equation}
%%==========
%だけ重くなる。
%計時中の砂時計の重心は明らかに下に移動し、重心の速度は下向きであるが、
%その加速度が上向きであることがこの重さの起源である。
%砂時計の高さ、つまり砂の落下する距離や砂時計のガラス部分の断面積には依存しないことは興味深い。
%



\bibliographystyle{amsplain} 
\bibliography{hourglass_weight}

\appendix

%=============================================
\section{下の砂層の厚さの時間変化}\label{250919092352}
%=============================================

砂の総質量は
%==========
\begin{equation} \label{250917175922} 
   M_0 = M_1(t) + M_2(t) + M_3(t)
\end{equation}
%==========
は定数である。
これは
%==========
\begin{equation} \label{250919085544} 
   \sigma K_0 =  \sigma K_1(t) + \sigma K_2(t) + m\mu\sqrt{\frac{2}{g}}\sqrt{H_0-K_2(t)}
\end{equation}
%==========
この式の時間微分をとると、
%==========
\begin{equation} \label{250917180035} 
  0 = \sigma \dot{K}_1(t) +  \sigma \dot{K}_2(t)  + m\mu\sqrt{\frac{2}{g}} \frac{\mathrm{d} }{\mathrm{d} t}\sqrt{H_0-K_2(t)} %- \frac{m\mu K_0}{\sqrt{2g}} \frac{\dot{K}_2(t)}{\sqrt{H_0-K_2(t)}}
\end{equation}
%==========
式\eqref{250919084914}より
%==========
\begin{equation} \label{250919085137} 
    0 =  -m\mu +  \sigma \dot{K}_2(t)  + m\mu\sqrt{\frac{2}{g}} \frac{\mathrm{d} }{\mathrm{d} t}\sqrt{H_0-K_2(t)}
\end{equation}
%==========
%==========
\begin{equation} \label{250917180242} 
   \frac{m \mu}{\sigma} =  \left(1 - \frac{1}{\sqrt{2g}}\frac{m \mu}{\sigma}  \frac{1}{\sqrt{H_0-K_2(t)}}\right) \dot{K}_2(t)
\end{equation}
%==========
ここで定数
%==========
\begin{equation} \label{250917180407} 
   A = \frac{m \mu}{\sigma}
\end{equation}
%==========
%==========
\begin{equation} \label{250917180426} 
   B  = \frac{A}{\sqrt{2g}}
\end{equation}
%==========
を導入すると微分方程式
%==========
\begin{equation} \label{250917180438} 
   A = \left(1 -   \frac{B}{\sqrt{H_0-K_2(t)}}\right) \dot{K}_2(t)
\end{equation}
%==========
を得る。
これは変数分離型なので、
%==========
\begin{equation} \label{250917180856} 
   A  \mathrm{d}t =  \left(1 -   \frac{B}{\sqrt{H_0-K_2(t)}}\right) \mathrm{d} K_2
\end{equation}
%==========
とすると
%==========
\begin{equation} \label{250917181005} 
   A t + C =  K_2(t) + 2B\sqrt{H_0-K_2(t)}
\end{equation}
%==========
とりあえずいまは$t=0$で$K_2=0$という初期条件でこの微分方程式を解くと（あとで初期条件の時刻を$t=\tau_{f0}$に平行移動する）、
積分定数
%==========
\begin{equation} \label{250917180719} 
  C = 2B\sqrt{H_0}
\end{equation}
%==========
を得る。
したがって
%==========
\begin{equation} \label{250917181329} 
   A t + 2B\sqrt{H_0} = K_2(t) + 2B\sqrt{H_0-K_2(t)}
\end{equation}
%==========
$K_2$を変数変換し
%==========
\begin{equation} \label{250917181440} 
   S(t) =  \sqrt{H_0 - K_2(t)}
\end{equation}
%==========
つまり
%==========
\begin{equation} \label{250917181759} 
   K_2(t) = H_0 - S(t)^2
\end{equation}
%==========
とすると、
%==========
\begin{equation} \label{250917181553} 
   A t + 2B\sqrt{H_0}  = H_0 - S(t)^2 + 2BS(t)
\end{equation}
%==========
%==========
\begin{equation} \label{250917181633} 
   S(t)^2 - 2BS(t) + 2B\sqrt{H_0} + At - H_0
\end{equation}
%==========
これを解くと
%==========
\begin{equation} \label{250917181902} 
   S(t) = B \pm \sqrt{B^2-2B\sqrt{H_0} -At + H_0}
\end{equation}
%==========
%==========
\begin{equation} \label{250917182147} 
   S(t) = B\pm \sqrt{(\sqrt{H_0}-B)^2-At}
\end{equation}
%==========
$\sqrt{H_0}-B$の符号をみるために$\epsilon = B/\sqrt{H_0}$を評価すると
%==========
\begin{equation} \label{250917182519} 
   \epsilon = \frac{B}{\sqrt{H_0}} = \frac{m\mu}{\sigma\sqrt{2gH_0}} = \frac{K_0/T_0}{\sqrt{2gH_0}}  \quad(\because \text{eq.~\eqref{250919090329}})
\end{equation}
%==========
右辺の分子は砂時計の速度スケール（砂層の初期高さと計時時間の比）で、分母は砂粒の（最大）自由落下速度である。したがって
%==========
\begin{equation} \label{250917183422} 
    \epsilon \ll 1
\end{equation}
%==========
としてよい。つまり
%==========
\begin{equation} \label{250917183450} 
   \sqrt{H_0}-B >0
\end{equation}
%========== 
である。
$t=0$で$s=\sqrt{H_0}$になるので式\eqref{250917182147}の複号はプラスをとる
%==========
\begin{equation} \label{250917182410} 
   S(t) = B + \sqrt{(\sqrt{H_0}-B)^2-At}
\end{equation}
%==========
式\eqref{250917181759}より
%==========
\begin{equation} \label{250917183653} 
   K_2(t) = H_0 - \left\{
   				B + \sqrt{(\sqrt{H_0}-B)^2-At}
   				\right\}^2
\end{equation}
%==========
%
この解は複雑なので、式\eqref{250917183422}を用いて近似する。
%==========
\begin{align}
   K_2(t) &= H_0 - \left\{
   				\epsilon \sqrt{H_0} + \sqrt{(\sqrt{H_0}-\epsilon \sqrt{H_0})^2-At}
   				\right\}^2   \label{250918054717a} \\
%   &= H_0 - \left\{
%   				\epsilon \sqrt{H_0} + \sqrt{H_0(1-\epsilon )^2-At}
%   				\right\}^2   \label{250918054717b} \\
%   &=   H_0 - H_0\left\{
%   				\epsilon  + \sqrt{(1-\epsilon )^2-\frac{At}{H_0}}
%   				\right\}^2  \label{250918054717c} \\
   &=    H_0 - H_0\left\{
   				 \sqrt{1-\frac{At}{H_0}}
   				\right\}^2  + \mathcal{O}(\epsilon)  \label{250918054717d}\\
   &=    H_0 - H_0\left(
   				 1-\frac{At}{H_0}
   				\right) + \mathcal{O}(\epsilon)  \label{250918054717e}\\
   &=    At + \mathcal{O}(\epsilon)  \label{250918054717f}
\end{align}
%==========
つまり$\mathcal{O}(\epsilon) $の誤差で微分方程式\eqref{250917180438}の解は
%==========
\begin{equation} \label{250918075020} 
   K_2(t) = At
\end{equation}
%==========
である。



この解は微分方程式\eqref{250917180438}を$t=0$で$K_2=0$という初期条件で解いたものであったが、本来は
$t=\tau_{f0}$で$K_2=0$とすべきであった。
つまり解は
%==========
\begin{equation} \label{250917184208} 
   K_2(t) =  \frac{A(t-\tau_{f0})}{H_0} = \frac{m \mu K_0}{M_0}(t-\tau_{f0})
\end{equation}
%==========
である。


\end{document}